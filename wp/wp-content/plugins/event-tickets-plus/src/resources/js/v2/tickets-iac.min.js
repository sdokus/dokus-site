/**
 * This JS file was auto-generated via Terser.
 *
 * Contributors should avoid editing this file, but instead edit the associated
 * non minified file file. For more information, check out our engineering docs
 * on how we handle JS minification in our engineering docs.
 *
 * @see: https://evnt.is/dev-docs-minification
 */

tribe.tickets=tribe.tickets||{},tribe.tickets.iac={},function($,obj){const $document=$(document);obj.selectors={ticketsPageMeta:".tribe-event-tickets-plus-meta",ticketsPageMetaEmail:".tribe-tickets-meta-email",ticketsPageMetaEmailReSend:".tribe-tickets__tickets-page-attendee-meta-resend-email",ticketsPageMetaEmailReSendTemplate:".tribe-tickets__tickets-page-attendee-meta-resend-email-template",formFieldName:".tribe-tickets__iac-field--name",formFieldEmail:".tribe-tickets__iac-field--email",formFieldNameUniqueErrorTemplate:".tribe-tickets__iac-unique-name-error-template",formFieldEmailUniqueErrorTemplate:".tribe-tickets__iac-unique-email-error-template"},obj.ticketsPageIACMetaEmailSaved={},obj.attendeeTicketData={},obj.ticketsPageMetaEmailReSendCheckboxRemove=function($input){$input.closest(obj.selectors.ticketsPageMetaEmail).find(obj.selectors.ticketsPageMetaEmailReSend).remove()},obj.ticketsPageMetaEmailReSendCheckboxAdd=function($input,attendeeId){if($input.closest(obj.selectors.ticketsPageMetaEmail).find(obj.selectors.ticketsPageMetaEmailReSend).length)return;const metaEmailResendTemplate=window.wp.template(obj.selectors.ticketsPageMetaEmailReSendTemplate.className()+"-"+attendeeId);$input.after(metaEmailResendTemplate())},obj.bindEmailChangeCheck=function(event){const $input=$(event.target),attendeeId=$input.closest(obj.selectors.ticketsPageMeta).data("attendee-id");obj.ticketsPageIACMetaEmailSaved[attendeeId]!==$input.val().trim()?obj.ticketsPageMetaEmailReSendCheckboxAdd($input,attendeeId):obj.ticketsPageMetaEmailReSendCheckboxRemove($input)},obj.bindAttendeeReSendEmail=function($container){if(!!!$container.data("attendee-resend-email"))return;$container.find(obj.selectors.ticketsPageMeta).each((function(){const $attendee=$(this),attendeeId=$attendee.data("attendee-id"),$emailMetaInput=$attendee.find(obj.selectors.ticketsPageMetaEmail).find("input");$emailMetaInput.length&&""!==$emailMetaInput.val()&&(obj.ticketsPageIACMetaEmailSaved[attendeeId]=$emailMetaInput.val().trim()),$emailMetaInput.on("keyup",obj.bindEmailChangeCheck)}))},obj.bindTicketsPageActions=function(event,$container){obj.bindAttendeeReSendEmail($container)},obj.getInputValuesFromMap=function(index,input){return input.value.trim()},obj.getInputValuesToArray=function($inputs){return $inputs.map(obj.getInputValuesFromMap).get()},obj.getInputValuesByField=function(ticketId,field){return obj.attendeeTicketData[ticketId][field]},obj.removeIacUniqueErrorMessage=function($input){$input.siblings(tribe.tickets.meta.selectors.formFieldInputHelperError).remove()},obj.addIacUniqueErrorMessage=function($input,field){if($input.siblings(tribe.tickets.meta.selectors.formFieldInputHelperError).length)return;let uniqueErrorTemplate;"name"===field?uniqueErrorTemplate=window.wp.template(obj.selectors.formFieldNameUniqueErrorTemplate.className()):"email"===field&&(uniqueErrorTemplate=window.wp.template(obj.selectors.formFieldEmailUniqueErrorTemplate.className())),$input.after(uniqueErrorTemplate())},obj.loadUniqueMetaValuesPerTicket=function(index,attendeeTicketsForm){const $attendeeTicketsForm=$(attendeeTicketsForm),ticketId=$attendeeTicketsForm.data("ticket-id");Object.prototype.hasOwnProperty.call(obj,ticketId)||(obj.attendeeTicketData[ticketId]={});const $emailInputs=$attendeeTicketsForm.find(obj.selectors.formFieldEmail+" input"),emailValues=obj.getInputValuesToArray($emailInputs);obj.attendeeTicketData[ticketId].email=emailValues;const $nameInputs=$attendeeTicketsForm.find(obj.selectors.formFieldName+" input"),nameValues=obj.getInputValuesToArray($nameInputs);obj.attendeeTicketData[ticketId].name=nameValues},obj.loadUniqueMetaValues=function(event,$form){$form.find(tribe.tickets.meta.selectors.formAttendeeTickets).each(obj.loadUniqueMetaValuesPerTicket)},obj.bindUniqueMetaValidation=function(event,$input,isValidField){if(!isValidField)return;const inputValue=$input.val().trim().toLowerCase();if(""===inputValue)return;const $inputWrapper=$input.closest(tribe.tickets.meta.selectors.formField);if(!$inputWrapper.hasClass(tribe.tickets.meta.selectors.formFieldUnique.className()))return;let field;const ticketId=$input.closest(tribe.tickets.meta.selectors.formAttendeeTickets).data("ticket-id");$inputWrapper.hasClass(obj.selectors.formFieldName.className())?field="name":$inputWrapper.hasClass(obj.selectors.formFieldEmail.className())&&(field="email");const uniqueValues=obj.getInputValuesByField(ticketId,field);if(2>uniqueValues.length)return;(isValidField=1===uniqueValues.filter((function(element){return element.toLowerCase()===inputValue})).length)?($input.removeClass(tribe.tickets.meta.selectors.formFieldInputError.className()),obj.removeIacUniqueErrorMessage($input)):($input.addClass(tribe.tickets.meta.selectors.formFieldInputError.className()),obj.addIacUniqueErrorMessage($input,field)),$input.data("valid",isValidField)},obj.addListeners=function(){$document.on("afterSetup.tribeTicketsPage",obj.bindTicketsPageActions),$document.on("beforeValidateForm.tribeTicketsMeta",obj.loadUniqueMetaValues),$document.on("afterValidateField.tribeTicketsMeta",obj.bindUniqueMetaValidation)},obj.ready=function(){},obj.addListeners(),$(obj.ready)}(jQuery,tribe.tickets.iac);